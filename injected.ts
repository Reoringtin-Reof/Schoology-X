console.log("injected :)");
let quotes = `Hello, world!

Join the CS club!
Time flies like an arrow. Fruit flies like a banana.
I had a crazy dream last night! I was swimming in an ocean of orange soda. Turns out it was just a Fanta sea.
What was Forrest Gumpâ€™s email password? 1forrest1
Need an ark to save two of every animal? I noah guy.
My grandpa has the heart of the lion and a lifetime ban from the zoo.
I donâ€™t trust stairs because theyâ€™re always up to something.
Why was Dumbo sad? He felt irrelephant.
A man sued an airline company after it lost his luggage. Sadly, he lost his case.
Yesterday, I accidentally swallowed some food coloring. The doctor says Iâ€™m okay, but I feel like Iâ€™ve dyed a little inside.
I was wondering why the ball was getting bigger. Then it hit me.
Waking up this morning was an eye-opening experience.
The Middle Ages were called the Dark Ages because there were too many knights.
My sister bet that I couldnâ€™t build a car out of spaghetti. You shouldâ€™ve seen her face when I drove pasta.
It's hard to explain puns to kleptomaniacs because they always take things literally.
Two windmills are standing in a wind farm. One asks, â€œWhatâ€™s your favorite kind of music?â€ The other says, â€œIâ€™m a big metal fan.â€
I canâ€™t believe I got fired from the calendar factory. All I did was take a day off!
I wasnâ€™t originally going to get a brain transplant, but then I changed my mind.
There was a kidnapping at school yesterday. Donâ€™t worry, though - he woke up!
Whatâ€™s the difference between a poorly dressed man on a bicycle and a nicely dressed man on a tricycle? A tire.
What do you call an alligator in a vest? An investigator.
Why did the scarecrow get an award? He was outstanding in his field.
The machine at the coin factory just suddenly stopped working, with no explanation. It doesnâ€™t make any cents.
Somebody stole all my lamps. I couldnâ€™t be more de-lighted!
Why was the baby ant confused? Because all his uncles were ants!
What did the sushi say to the bee? Wasabee!
Did you know deer can jump higher than the average house? Itâ€™s because of their strong hind legs and the fact that the average house canâ€™t jump.
The past, the present, and the future walk into a bar. It was tense!
What did the duck say when she purchased new lipstick? Put it on my bill!
Did you hear about that cheese factory that exploded in France? There was nothing left but de Brie!
I tried to take a photo of a wheat field. It turned out grainy.
A photon checks into a hotel. The front desk asks if it has any luggage. It replies, â€œno, Iâ€™m traveling light.â€
I'm afraid of speed bumps, but I'm slowly getting over it.
I was caught stealing luggage, but my trial only lasted a few minutes.  It was a brief case.
Why did the can crusher quit her job? It was soda-pressing.
My friend fell into an upholstery machine. Heâ€™s fully recovered now.
What do you call a broken can opener? A canâ€™t opener.
Why canâ€™t bikes stand up unsupported? Theyâ€™re two tired.
Why do people love Switzerland? Well, the flag is a big plus
I got fired from my job at the keyboard factory.  I wasn't putting in enough shifts.
Why did the belt go to jail? It held up a pair of pants.
Most people are shocked when they find out how bad an electrician I am.
Iâ€™ve got a phobia of over-engineered buildings. Itâ€™s a complex complex complex.
My landlord says he needs to come talk to me about how high my heating bill is. I told him, â€œMy door is always openâ€.
Making mirrors is a job I can really see myself doing.
What's the best way to make a hot dog stand? Take away its chair.
What do you call a dog magician? A Labracadabrador Retriever.
Iâ€™m reading a book about anti-gravity. I just canâ€™t put it down.
I stayed up all night to see where the sun went. Then it dawned on me.
RIP Boiling Water. You will be mist.
Broken pencils are pointless.
â€œDoctor, help! Iâ€™m shrinking!â€ â€œTake this and youâ€™ll be back to normal in a few weeks. Until then, youâ€™ll just have to be a little patient.â€
I donâ€™t enjoy computer jokes. Not one bit.
Did you hear that Magnesium formed an oxide layer? OMg!
Whatâ€™d the pirate say on his 80th birthday? Aye matey!
Somebody just broke into my apartment and stole every lamp, flashlight, and lightbulb. Iâ€™m so delighted.
How many tickles does it need before an octopus laughs? Ten tickles.
I just opened a fortune cookie with nothing inside. How unfortunate!
I fired my masseuse today. He just rubbed me the wrong way
Why are two helium isotopes so funny? HeHe!
Argon walks into a bar. The bartender said â€œHey, get out of here, we donâ€™t serve noble gasesâ€. Argon didnâ€™t react at all.
I stayed on a ranch last weekend, but couldnâ€™t really sleep well. Every time Iâ€™d drift off, a female horse would whinny and wake me back off. It was a night mare.
Did you hear about all the hidden meanings in the Lion King? Yeah, itâ€™s full of Simbalism.
Whatâ€™s the difference between Batman and a shoplifter? Batman can go into a store without Robin.
My friend David just had his ID stolen. We just call him Dav now.
A Spanish magician told his audience he would disappear on the count of three. He wrapped his cape around himself and counted. â€œUnoâ€¦ Dosâ€¦â€ and then disappeared without a Tres.
Did you hear about the claustrophobic astronaut? He needed some space. 
How did the dictionary end up starring on Broadway? In a play on words. 
I used to be addicted to the hokey pokey. But then I turned myself around.
Did you hear about the man who lost his left side? He's all right now.
I couldn't figure out how to put my seatbelt on, but then it clicked.
I tried to make a belt out of watches. It was a waist of time.
Thanks for explaining the word 'many' to me, it means a lot.
Two antennas met on a roof, fell in love and got married. The ceremony wasn't much, but the reception was excellent.
I'm reading a book about anti-gravity. It's impossible to put down!
The shovel was a ground-breaking invention.
It was a terrible summer for Humpty Dumpty... but he had a great fall.
You didnâ€™t hear about the three big holes in the ground? Well, well, well.
Iâ€™m a big fan of whiteboards. I find them quite re-markable.
Did you hear about the two silk worms in a race? It ended in a tie!
Iâ€™m friends with 25 letters of the alphabet. I donâ€™t know why.
What would you call a fish with a missing eye? A fsh, probably.
Broken puppets for sale. No strings attached.
Once youâ€™ve seen one shopping center youâ€™ve seen a mall.
Jill broke her finger today. On the other hand she was completely fine.
I lost my job at the bank on my very first day. A woman asked me to check her balance, so I pushed her over.
A police officer just knocked on my door and told me my dogs are chasing people on bikes. Thatâ€™s ridiculous. My dogs donâ€™t even own bikes.
What do you call a bee that canâ€™t make up its mind? A maybe.
Is it ignorance or apathy that's destroying the world today? I don't know and don't really care.
How do you throw a party in outer space? You planet.
Two fish are in a tank, one says to the other "how do you drive this thing?"
I hate how funerals are always at 9 a.m. Iâ€™m not really a mourning person.
What did one flag say to the other? Nothing, it just waved.
I poured root beer in a square glass. Now I just have beer.
There are 10 types of people in the world: those who understand binary and those who don't.
Why did the computer programmer quit?  He didn't get arrays.
I would tell you a UDP joke, but you might not get it.
Why canâ€™t your nose grow to be 12 inches long? Because then it would be a foot.
I love the way the earth rotates.  It really makes my day.
Why was Pavlov's hair so soft?  Because he used classical conditioning.`;
let allowedURL = [
    "https://schoology.shschools.org/home",
    "https://schoology.shschools.org/home/",
    "https://schoology.shschools.org/",
    "https://schoology.shschools.org",
];
let currentclass: any = null;
let distancefromtoday = 0;
let distancefromtodayWeeks = 0;
let order = [
    "", // 1
    "", // 2
    "", // 3
    "", // 4
    "", // 5
    "", // 6
    "", // 7
    "End",
];
const courseIds = [
    "7356990861",
    "7356990931",
    "7356990703",
    "7356991016",
    "7356990663",
    "7356990984",
    "7356990769",
];
const Weekdays = [
    "Sunday",
    "Monday",
    "Tuesday",
    "Wednesday",
    "Thursday",
    "Friday",
    "Saturday",
];

type Time = {
    hour: number;
    min: number;
};
type Day = 1 | 2 | 3 | 4 | 5 | 6 | 7;

interface Period {
    name: string;
    day: Day;
    time: Time;
}
let courses: Period[] = [
    // Day 1
    { name: order[0], day: 1, time: { hour: 8, min: 25 } }, // 1
    { name: order[1], day: 1, time: { hour: 10, min: 0 } }, // 2
    { name: order[2], day: 1, time: { hour: 11, min: 10 } }, // 3
    { name: order[3], day: 1, time: { hour: 13, min: 0 } }, // 4
    { name: order[4], day: 1, time: { hour: 14, min: 15 } }, // 5
    { name: "End", day: 1, time: { hour: 15, min: 15 } }, // 5

    // Day 2
    { name: order[5], day: 2, time: { hour: 8, min: 25 } }, // 6
    { name: order[6], day: 2, time: { hour: 10, min: 30 } }, // 7
    { name: order[0], day: 2, time: { hour: 12, min: 20 } }, // 1
    { name: order[1], day: 2, time: { hour: 13, min: 30 } }, // 2
    { name: "End", day: 2, time: { hour: 15, min: 15 } }, // 5

    // Day 3
    { name: order[2], day: 3, time: { hour: 9, min: 25 } }, // 3
    { name: order[3], day: 3, time: { hour: 10, min: 35 } }, // 4
    { name: order[4], day: 3, time: { hour: 12, min: 25 } }, // 5
    { name: order[5], day: 3, time: { hour: 13, min: 40 } }, // 6
    { name: "End", day: 3, time: { hour: 15, min: 15 } }, // 5

    // Day 4
    { name: order[6], day: 4, time: { hour: 8, min: 25 } }, // 7
    { name: order[0], day: 4, time: { hour: 10, min: 0 } }, // 1
    { name: order[1], day: 4, time: { hour: 11, min: 10 } }, // 2
    { name: order[2], day: 4, time: { hour: 13, min: 0 } }, // 3
    { name: "End", day: 4, time: { hour: 15, min: 15 } }, // 5

    // Day 5
    { name: order[3], day: 5, time: { hour: 8, min: 25 } }, // 4
    { name: order[4], day: 5, time: { hour: 10, min: 0 } }, // 5
    { name: order[5], day: 5, time: { hour: 13, min: 0 } }, // 6
    { name: order[6], day: 5, time: { hour: 14, min: 15 } }, // 7
    { name: "End", day: 5, time: { hour: 15, min: 15 } }, // 5
];
function refresh() {
    courses = [
        // Day 1
        { name: order[0], day: 1, time: { hour: 8, min: 25 } }, // 1
        { name: order[1], day: 1, time: { hour: 10, min: 0 } }, // 2
        { name: order[2], day: 1, time: { hour: 11, min: 10 } }, // 3
        { name: order[3], day: 1, time: { hour: 13, min: 0 } }, // 4
        { name: order[4], day: 1, time: { hour: 14, min: 15 } }, // 5
        { name: "End", day: 1, time: { hour: 15, min: 15 } }, // 5

        // Day 2
        { name: order[5], day: 2, time: { hour: 8, min: 25 } }, // 6
        { name: order[6], day: 2, time: { hour: 10, min: 30 } }, // 7
        { name: order[0], day: 2, time: { hour: 12, min: 20 } }, // 1
        { name: order[1], day: 2, time: { hour: 13, min: 30 } }, // 2
        { name: "End", day: 2, time: { hour: 15, min: 15 } }, // 5

        // Day 3
        { name: order[2], day: 3, time: { hour: 9, min: 25 } }, // 3
        { name: order[3], day: 3, time: { hour: 10, min: 35 } }, // 4
        { name: order[4], day: 3, time: { hour: 12, min: 25 } }, // 5
        { name: order[5], day: 3, time: { hour: 13, min: 40 } }, // 6
        { name: "End", day: 3, time: { hour: 15, min: 15 } }, // 5

        // Day 4
        { name: order[6], day: 4, time: { hour: 8, min: 25 } }, // 7
        { name: order[0], day: 4, time: { hour: 10, min: 0 } }, // 1
        { name: order[1], day: 4, time: { hour: 11, min: 10 } }, // 2
        { name: order[2], day: 4, time: { hour: 13, min: 0 } }, // 3
        { name: "End", day: 4, time: { hour: 15, min: 15 } }, // 5

        // Day 5
        { name: order[3], day: 5, time: { hour: 8, min: 25 } }, // 4
        { name: order[4], day: 5, time: { hour: 10, min: 0 } }, // 5
        { name: order[5], day: 5, time: { hour: 13, min: 0 } }, // 6
        { name: order[6], day: 5, time: { hour: 14, min: 15 } }, // 7
        { name: "End", day: 5, time: { hour: 15, min: 15 } }, // 5
    ];
}
let deleteAsign: any = null; // Do something with the event
let initial = true; // Do something with the event
let old: any = null;
window.addEventListener("deleteAsign", function (e: Event) {
    // Cast the event to CustomEvent
    const customEvent = e as CustomEvent;

    if (customEvent.detail && typeof customEvent.detail.value !== "undefined") {
        const deleteAsignValue = customEvent.detail.value; // Access the value from the event detail
        deleteAsign = deleteAsignValue; // Set the variable
        if (initial) {
            initial = false; // Do something with the event
            old = deleteAsign;
        } else {
            if (old !== deleteAsign) {
                location.reload();
            }
        }
    } else {
        console.error("No value found in event detail");
    }
});

function adjustBrightness(hexColor: any, percent: any) {
    // Ensure percent is between -100 and 100
    percent = Math.max(-100, Math.min(100, percent));

    // Convert hex to RGB
    let r = parseInt(hexColor.slice(1, 3), 16);
    let g = parseInt(hexColor.slice(3, 5), 16);
    let b = parseInt(hexColor.slice(5, 7), 16);

    // Calculate adjustment factor
    let adjustmentFactor = Math.round((percent / 100) * 255);

    // Adjust brightness
    r = Math.min(255, Math.max(0, r + adjustmentFactor));
    g = Math.min(255, Math.max(0, g + adjustmentFactor));
    b = Math.min(255, Math.max(0, b + adjustmentFactor));

    // Convert RGB back to hex
    let newHex =
        "#" +
        ("0" + r.toString(16)).slice(-2) +
        ("0" + g.toString(16)).slice(-2) +
        ("0" + b.toString(16)).slice(-2);

    return newHex;
}

function getCurrentClass(
    day: Day,
    currentHour: number,
    currentMinute: number
): string | null {
    let currentClass: Period | null = null;

    // Find the current class by iterating through the list
    for (const period of courses) {
        if (period.day === day) {
            // Compare the period's time with the current time
            if (
                period.time.hour < currentHour ||
                (period.time.hour === currentHour &&
                    period.time.min - 5 <= currentMinute)
            ) {
                currentClass = period;
            }
        }
    }

    // Return the name of the class if found, otherwise return null
    return currentClass ? currentClass.name : null;
}

// let originalColor = "#ffffff";
// let hoverColor = adjustBrightness(originalColor, -10); // Lighten by 20%

let originalColor = "#0677bb";
let hoverColor = adjustBrightness(originalColor, 10); // Lighten by 20%

window.addEventListener("colorChange", function (e: Event) {
    // Cast the event to CustomEvent
    const customEvent = e as CustomEvent;

    if (customEvent.detail && typeof customEvent.detail.value !== "undefined") {
        const deleteAsignValue = customEvent.detail.value; // Access the value from the event detail
        originalColor = deleteAsignValue;
        hoverColor = adjustBrightness(originalColor, 10); // Lighten by 20%
        changeHeaderColor();
    } else {
        console.error("No value found in event detail");
    }
});

function changeHeaderColor() {
    // Function to check if any ancestor of the element is a <header>
    function hasHeaderAncestor(element: Element) {
        while (element.parentElement) {
            // Loop until there are no more parents
            element = element.parentElement; // Move up the DOM tree
            if (element.tagName.toLowerCase() === "header") {
                return true; // Found a <header> ancestor
            }
        }
        return false; // No <header> ancestor found
    }
    // hoverColor = "#24a5f5";

    // Select all <a> and <li> elements
    let anchors = document.getElementsByTagName("a");
    let listItems = document.getElementsByTagName("li");
    let btns = document.getElementsByTagName("button");
    const header = document.getElementsByClassName(
        "_1tpub _3mp5E _24W2g util-justify-content-space-between-3euFK"
    )[0] as HTMLElement;
    header.style.backgroundColor = originalColor;
    (
        document.getElementsByClassName(
            "_1Z0RM Header-bottom-border-2ZE-7 _3v0y7 _349XD"
        )[0] as HTMLElement
    ).style.backgroundColor = originalColor;
    (
        document.getElementsByClassName(
            "_1Z0RM Header-bottom-border-2ZE-7 _3v0y7 _349XD"
        )[0] as HTMLElement
    ).style.borderTop = `3px solid ${originalColor}`;

    let IMGParent = document.getElementsByClassName(
        "util-height-six-3PHnk util-width-auto-1-HYR util-max-width-sixteen-3-tkk fjQuT _1tpub _2JX1Q"
    )[0] as HTMLElement;

    const IMG = IMGParent.firstElementChild as HTMLImageElement;

    IMG.src = "https://i.ibb.co/v3Cc2mX/shs-removebg-preview.png"; // Replace this with the direct URL of the image

    for (let i = 0; i < anchors.length; i++) {
        if (hasHeaderAncestor(anchors[i])) {
            if (anchors[i].title !== "Home") {
                anchors[i].style.backgroundColor = originalColor;
                anchors[i].style.borderRadius = "10px";

                anchors[i].addEventListener("mouseover", function () {
                    anchors[i].style.backgroundColor = hoverColor;
                });
                anchors[i].addEventListener("mouseleave", function () {
                    anchors[i].style.backgroundColor = originalColor;
                });
            }
        }
    }
    for (let i = 0; i < btns.length; i++) {
        if (hasHeaderAncestor(btns[i])) {
            btns[i].style.backgroundColor = originalColor;
            if (originalColor !== "#ffffff") {
                if (
                    (btns[i].firstElementChild as HTMLElement).role !==
                    "menuitem"
                ) {
                    (btns[i].firstElementChild as HTMLElement).style.color =
                        "#ffffff";
                }
            }
            btns[i].style.borderRadius = "10px";
            btns[i].addEventListener("mouseover", function () {
                btns[i].style.backgroundColor = hoverColor;
            });
            btns[i].addEventListener("mouseleave", function () {
                btns[i].style.backgroundColor = originalColor;
            });
        }
    }
    // Check for <li> elements
    for (let i = 0; i < listItems.length; i++) {
        if (hasHeaderAncestor(listItems[i])) {
            const item = listItems[i].firstElementChild as HTMLElement;
            if (item) {
                if (
                    item.className !==
                    "_2JX1Q _1tpub _3EZZc _1FFms nOK4_ sExtlink-processed"
                ) {
                    listItems[i].style.borderRadius = "10px";
                    listItems[i].style.backgroundColor = originalColor;
                    if (originalColor !== "#ffffff") {
                        item.style.color = "#ffffff";
                    }
                    listItems[i].addEventListener("mouseover", function () {
                        listItems[i].style.backgroundColor = hoverColor;
                    });
                    listItems[i].addEventListener("mouseleave", function () {
                        listItems[i].style.backgroundColor = originalColor;
                    });
                }
                // Example: listItems[i].style.color = "red";
            }
        }
    }
}
function getClass() {
    const now = new Date();
    // let now = new Date(2024, 10, 28, 9, 30, 10, 10);

    // const currentDays: Day =
    //     now.getDay() === 0 ? 5 : (now.getDay() as Day); // Adjust Sunday to be day 7

    const currentDays: Day = now.getDay() as Day; // Adjust Sunday to be day 7
    const currentHour = now.getHours();
    const currentMinute = now.getMinutes();
    let ongoingClass: any = getCurrentClass(
        currentDays,
        currentHour,
        currentMinute
    );

    return ongoingClass;
}
function waitForElement(className: string, callback: Function) {
    // Check if the element is already present
    let element = document.querySelector(className);
    if (element) {
        callback(element);
        return;
    }

    // Create a new instance of MutationObserver
    const observer = new MutationObserver((mutationsList, observer) => {
        for (let mutation of mutationsList) {
            if (mutation.type === "childList") {
                let element = document.querySelector(className);
                if (element) {
                    callback(element);
                    observer.disconnect(); // Stop observing once the element is found
                    break;
                }
            }
        }
    });

    // Start observing the document for changesschedule
    observer.observe(document.body, { childList: true, subtree: true });
}
changeHeaderColor();
function coursesChange() {
    setInterval(function () {
        waitForElement(".Card-card-data-17m6S", function () {
            const courses = document.getElementsByClassName(
                "Card-card-data-17m6S"
            );
            const imgs = document.getElementsByClassName(
                " _2q19q Card-card-image-uV6Bu"
            );

            let ongoingClass = getClass();
            // const coursediv = document.getElementsByClassName(
            //     "_13cCs _2M5aC _24avl _3ghFm _3LeCL _31GLY _9GDcm util-height-six-3PHnk util-pds-icon-default-2kZM7 _1Z0RM _1wP6w _2qcpH xjR5v util-v2-header-background-color-22JtI _1Z0RM fjQuT uQOmx"
            // )[0] as HTMLElement;

            // const span = coursediv.firstElementChild as HTMLElement;

            for (let i = 0; i < Math.min(courses.length, 7); i++) {
                const courseDiv = courses[i] as HTMLElement;
                let firstChild = courseDiv.firstElementChild;
                let secondChild = firstChild?.firstElementChild;
                let className = secondChild?.innerHTML;
                if (className) {
                    order[i] = className;
                }
                // ongoingClass = "Geometry Honors";
                if (order.indexOf(ongoingClass) == i) {
                    if (ongoingClass !== null) {
                        courseDiv.style.backgroundColor = "#000000";
                    }
                } else {
                    courseDiv.style.backgroundColor = "#ffffff";
                }

                courseDiv.style.borderRadius = "0  0 15px 15px";

                let imgelm = imgs[i] as HTMLElement;
                imgelm.style.borderRadius = " 15px 15px 0 0";

                const div = courseDiv.parentElement as HTMLElement;
                (div.parentElement as HTMLElement).style.borderRadius = "15px";

                const div2 = courseDiv.parentElement as HTMLElement;
                // const div3 = div2.parentElement as HTMLElement;
                if (div2) {
                    imgelm.style.borderColor = "blue";

                    courseDiv.style.borderColor = "blue";
                    // ongoingClass = "Geometry Honors";
                    // if (order.indexOf(ongoingClass) == i) {
                    //     if (ongoingClass !== null) {
                    //         div2.style.borderColor = "blue";
                    //     }
                    // }

                    div2.style.borderRadius = "15px";
                }
            }
            localStorage.setItem("schedule", JSON.stringify(order));

            createSchedule();
        });
    }, 100);
}

function redirect() {
    // let repeated = 0;
    // let interval = setInterval(function () {
    //     repeated += 1;
    //     if (repeated >= 10) {
    //         clearInterval(interval);
    //     }
    // }, 20);

    setTimeout(function () {
        if (currentclass !== null && order[currentclass] !== "End") {
            alert(
                `https://schoology.shschools.org/course/${courseIds[currentclass]}`
            );
            window.location.replace(
                `https://schoology.shschools.org/course/${courseIds[currentclass]}`
            );
        } else {
        }
    }, 200);
}
coursesChange();
document

    .getElementsByClassName(
        "_13cCs _2M5aC _24avl _3ghFm _3LeCL _31GLY _9GDcm util-height-six-3PHnk util-pds-icon-default-2kZM7 _1Z0RM _1wP6w _2qcpH xjR5v util-v2-header-background-color-22JtI util-v2-header-background-color-22JtI _1Z0RM fjQuT uQOmx"
    )[0]
    .addEventListener("click", redirect);

function next(amount: number) {
    distancefromtoday += amount;
    // if (distancefromtoday == 6) {

    // }
    let elem = document.getElementById("calender");
    if (elem?.parentNode) {
        elem.parentNode.removeChild(elem);
    }
    if (allowedURL.includes(window.location.href)) {
        createSchedule();
    }
}
function hovered(arrownum: number) {
    let arrow = document.getElementById("arrow" + arrownum);
    if (arrow) {
        arrow.style.fill = "#2020e8";
        arrow.style.cursor = "pointer";
    }
}
function unhovered(arrownum: number) {
    let arrow = document.getElementById("arrow" + arrownum);
    if (arrow) {
        arrow.style.fill = "#434343";
        arrow.style.cursor = "auto";
    }
}
let saveState: any = {};

if (allowedURL.includes(window.location.href)) {
    setTimeout(function () {
        checkBoxmaker();

        createSchedule();
        let p = document.createElement("p");
        p.innerHTML = "";
        p.id = "progress";
        document.getElementById("todo")?.appendChild(p);
        p.style.position = "absolute";
        p.style.top = "80px";
        p.style.left = "95%";
        p.style.fontSize = "16px";

        let div = document.createElement("div");
        div.id = "myProgress";
        document.getElementById("todo")?.appendChild(div);
        div.style.position = "absolute";
        div.style.top = "75px";
        div.style.left = "75%";
        div.style.width = "0%";
        div.style.height = "22px";
        div.style.borderRadius = "10px";
        div.style.backgroundColor = "#0677bb";
        div.style.textAlign = "center";
        div.style.color = "white";
        div.style.margin = "auto";

        // div.style.fontSize = "16px";
        div.style.fontSizeAdjust = "0.6";

        div.style.padding = "2px";

        let div2 = document.createElement("div");
        div2.id = "myProgressFrame";
        document.getElementById("todo")?.appendChild(div2);
        div2.style.position = "absolute";

        div2.style.top = "75px";
        div2.style.left = "75%";
        div2.style.width = "200px";
        div2.style.height = "22px";
        div2.style.borderRadius = "10px";
        div2.style.borderWidth = "2px";
        div2.style.borderStyle = "solid";

        // div2.style.backgroundColor = "#0677bb";

        changeAmount();
    }, 600);
}

async function createSchedule() {
    if (allowedURL.includes(window.location.href)) {
        // let quote_list: any = [];
        // await fetch("http://cs.shschools.org/kmo/quotes.txt")
        //     .then((response) => response.text())
        //     .then((data) => {
        //         quote_list = data.split("\n");
        //     });
        const dateNow = new Date();

        let dayNow = dateNow.getDate();

        refresh();
        const div = document.createElement("div");
        const divstyle = div.style;
        divstyle.width = "100px";
        div.id = "calender";
        divstyle.height = "350px";
        divstyle.backgroundColor = "#ffffff";
        divstyle.position = "absolute";
        div.className = "todo todo-wrapper";
        divstyle.top = "8.25%";
        divstyle.left = "2%";
        divstyle.padding = "15px";
        divstyle.textAlign = "";

        divstyle.fontSize = "12px";
        divstyle.fontFamily = "Roboto";

        const btn = document.createElement("button");
        const btnStyle = btn.style;
        btnStyle.width = "100px";
        btn.id = "notes";
        btn.innerHTML = "Notes";
        btnStyle.height = "30px";
        // btnStyle.backgroundColor = "#ffffff";
        btnStyle.position = "absolute";
        // btn.className = "todo todo-wrapper";
        btnStyle.top = "40%";
        btnStyle.left = "3%";
        btnStyle.padding = "15px";
        // btnStyle.textAlign = "";
        btnStyle.zIndex = "100";
        btnStyle.fontSize = "12px";
        btnStyle.fontFamily = "Roboto";
        btn.addEventListener("click", function () {
            location.replace(`/${btn.id}`);
        });
        let now = new Date();
        now.setDate(now.getDate() + distancefromtoday);

        const day = now.getDay();
        const date = now.getDate();
        const month = now.getMonth();

        div.innerHTML = `<svg style="position:Relative; left:40px" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Z"/></svg><h2 style="position:Relative; left:10px">Schedule</h2>${
            Weekdays[day]
        } ${month + 1}/${date}`;
        div.innerHTML +=
            '<div style="width:`24px`;height:`24px`;background-color:`grey`;position: absolute;top:5px; left:105px" onclick="next(1)" onmouseover="hovered(1)" onmouseleave="unhovered(1)"><svg  id="arrow1" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="m321-80-71-71 329-329-329-329 71-71 400 400L321-80Z"/></svg></div>';
        div.innerHTML +=
            '<div   style="width:`24px`;height:`24px`;background-color:`grey`;position: absolute;top:5px; left:5px" onclick="next(-1)" onmouseover="hovered(2)" onmouseleave="unhovered(2)"><svg id="arrow2" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="M400-80 0-480l400-400 71 71-329 329 329 329-71 71Z"/></svg></div>';

        div.innerHTML += `<hr style="border-top: 1px solid #bbb;" class="solid"></br>`;
        //working

        let periodCount = 0;
        // let save2 = {};
        let save2 = localStorage.getItem("saveState2");
        if (save2 !== null) {
            if (JSON.parse(save2)) {
                save2 = JSON.parse(save2);
                localStorage.setItem("saveState2", JSON.stringify(save2));
            }
        }
        // if (document.getElementById("calender") == null && order[0] !== "") {
        let save3 = localStorage.getItem("schedule");

        if (save3 !== null) {
            order = JSON.parse(save3);
            refresh();
        }

        if (order[0] !== "" || order == null) {
            if (now.getDay() == 6 || now.getDay() == 0) {
                div.innerHTML +=
                    " <h3 style='text-align:left'>Weekend! No Classes.<h3>";
            } else {
                let element = document.getElementById("calender");
                element?.parentNode?.removeChild(element);

                for (const period of courses) {
                    if (period.day === day) {
                        if (period.name !== "End") {
                            periodCount += 1;
                            // if (save2) {
                            //     print;
                            //     if (save2.find(period.name)) {
                            //     }
                            // }
                            // let input = document.createElement("select");
                            // // input.type = "select";
                            // input.style.width = "40px";
                            // for (let i = 0; i < 5; i++) {
                            //     let option = document.createElement("option");
                            //     option.innerHTML = String(i);

                            //     input.appendChild(option);
                            // }

                            // input.style.height = "22px";
                            // input.style.borderRadius = "10px";
                            // input.style.left = "80px";
                            // input.style.top = periodCount * 50 - periodCount + 40 + "px";
                            // input.style.position = "absolute";
                            // input.style.fontSize = "10px";
                            // input.className = "progressCheck2";
                            // div.appendChild(input);

                            let startTime = "";

                            if (period.time.hour > 12) {
                                startTime =
                                    period.time.hour -
                                    12 +
                                    ":" +
                                    period.time.min;
                                if (period.time.min == 0) {
                                    startTime =
                                        period.time.hour -
                                        12 +
                                        ":" +
                                        period.time.min +
                                        "0";
                                }
                            } else {
                                startTime =
                                    period.time.hour + ":" + period.time.min;

                                if (period.time.min == 0) {
                                    startTime =
                                        period.time.hour +
                                        ":" +
                                        period.time.min +
                                        "0";
                                }
                            }
                            let endTime = "";
                            if (period.time.hour + 1 > 12) {
                                endTime =
                                    period.time.hour +
                                    1 -
                                    12 +
                                    ":" +
                                    period.time.min;

                                if (period.time.min == 0) {
                                    endTime =
                                        period.time.hour +
                                        1 -
                                        12 +
                                        ":" +
                                        period.time.min +
                                        "0";
                                }
                            } else {
                                endTime =
                                    period.time.hour +
                                    1 +
                                    ":" +
                                    period.time.min;

                                if (period.time.min == 0) {
                                    endTime =
                                        period.time.hour +
                                        1 +
                                        ":" +
                                        period.time.min +
                                        "0";
                                }
                            }

                            if (order[currentclass] == period.name) {
                                div.innerHTML += `
    
                    
                        <span style='text-align:right'>${period.name}</span><br>(${startTime} - ${endTime})<br><br>
                      `;
                            } else {
                                div.innerHTML += `
                    
                        <b>${period.name} </b><br>(${startTime} - ${endTime})<br><br>
                  `;
                            }
                        }
                    }
                }
                divstyle.boxShadow = "0 1px 3px 0 rgba(0,0,0,.15)";
            }
        } else {
            div.innerHTML +=
                " <h3 style='text-align:left'>Schedule not saved, open course menu to load. Make sure your courses are ordered in the order you have them!<h3>";
        }
        // alert(quotes[dayNow]);
        let quotesArr = quotes.split("\n");
        let todayQuote = quotesArr[dayNow];
        todayQuote = todayQuote
            .replace(/â€œ/g, '"') // Replace the opening quotation marks
            .replace(/â€/g, '"') // Replace the closing quotation marks
            .replace(/â€™/g, "'"); // Replace the apostrophe

        div.innerHTML += `<br/><span style="font-size:10px">${todayQuote}</span>`;

        const container = document.getElementById("container");
        if (container) {
            container.appendChild(div);
            container.appendChild(btn);
        }
        // div.innerHTML +=
        //     "<button onclick='crash()' style=`width=50px;height=50px;`>hi</button>";
    }
}
// }
function crash() {
    // alert();
    for (let i = 0; i < 5; i++) {
        window.location.reload();
    }
}
function changeAmount() {
    let bar = document.getElementById("progress");
    if (bar) {
        let progressCheck = document.getElementsByClassName(
            "progressCheck"
        ) as HTMLCollection;

        let checks = 0;

        for (let i = 0; i < progressCheck.length; i++) {
            let inputThing = progressCheck[i] as HTMLInputElement;
            if (inputThing.checked == true) {
                checks += 1;
            }
        }
        let myProgress = document.getElementById("myProgress");
        if (myProgress) {
            let targetWidth = (checks / progressCheck.length) * 200;

            let width = Number(
                myProgress.style.width.slice(
                    0,
                    myProgress.style.width.length - 2
                )
            );
            let increase: boolean = true;

            if (width < targetWidth) {
                increase = true;
            } else {
                increase = false;
            }

            let id = setInterval(frame, 8);

            function frame() {
                if (increase && width >= targetWidth) {
                    width = 0;
                    clearInterval(id);
                } else if (increase == false && width <= targetWidth) {
                    width = 0;
                    clearInterval(id);
                } else {
                    if (increase) {
                        width++;
                    } else {
                        width--;
                    }
                    if (myProgress) {
                        myProgress.style.width = width + "px";
                        myProgress.innerHTML = `${String(
                            Math.round(width / 2)
                        )}%`;
                        myProgress.style.backgroundColor = `rgb(${
                            255 / 2 - (Math.round(width / 2) * 2.25) / 2
                        }, ${Math.round(width / 2) * 2.25},${
                            (Math.round(width / 2) * 2.25) / 2
                        } )`;
                    }
                }
            }
        }
        bar.innerHTML = `${checks}/${progressCheck.length}`;
    }
}
function checkBoxmaker() {
    waitForElement(
        ".upcoming-event.upcoming-event-block.course-event",
        function () {
            let upcoming = document.getElementsByClassName(
                "upcoming-event upcoming-event-block course-event"
            );

            for (let i = 0; i < upcoming.length; i++) {
                if (
                    upcoming[i].className.includes("hidden-important") == false
                ) {
                    let input = document.createElement("input");
                    input.type = "checkbox";
                    input.style.width = "30px";
                    input.style.height = "30px";
                    input.style.borderRadius = "20px";
                    input.style.left = "1120px";
                    input.style.position = "absolute";
                    input.className = "progressCheck";
                    let save = localStorage.getItem("saveState");
                    upcoming[i].appendChild(input);

                    let children = input.parentElement?.firstElementChild
                        ?.children as HTMLCollection;
                    let childrenchild = children[0].children[1].children;
                    if (childrenchild) {
                        for (let i = 0; i < childrenchild.length; i++) {
                            if (
                                childrenchild[i].className ==
                                "sExtlink-processed"
                            ) {
                                let original = childrenchild[i].innerHTML;
                                let lower = original.toLowerCase();

                                if (
                                    lower.includes("quiz") ||
                                    lower.includes("test") ||
                                    lower.includes("minor") ||
                                    lower.includes("c4u") ||
                                    lower.includes("cfu") ||
                                    lower.includes("major")
                                ) {
                                    input.style.accentColor = "green";

                                    let elm = childrenchild[i] as HTMLElement;
                                    elm.style.color = "red";
                                }
                                // let child = children[i].firstElementChild;

                                // if (child) {
                                if (save !== null) {
                                    saveState = JSON.parse(save);
                                    if (
                                        saveState[childrenchild[i].innerHTML] ==
                                        true
                                    ) {
                                        input.checked = true;
                                        childrenchild[
                                            i
                                        ].innerHTML = `<s>${childrenchild[i].innerHTML}</s>`;
                                        let child: any =
                                            childrenchild[i].parentElement
                                                ?.parentElement?.parentElement
                                                ?.parentElement;

                                        child.style.opacity = "0.8";
                                        let timout = setInterval(() => {
                                            if (deleteAsign == false) {
                                                clearInterval(timout);
                                            } else if (
                                                deleteAsign !== null &&
                                                deleteAsign == true
                                            ) {
                                                child.remove();
                                                clearInterval(timout);
                                            }
                                        }, 1);
                                    } else {
                                        input.checked = false;
                                        let child: any =
                                            childrenchild[i].parentElement
                                                ?.parentElement?.parentElement
                                                ?.parentElement;

                                        child.style.opacity = "1";
                                        childrenchild[
                                            i
                                        ].innerHTML = `${childrenchild[
                                            i
                                        ].innerHTML.replace(/<\/?s>/g, "")}`;
                                    }
                                }
                            }
                        }
                    }

                    input.addEventListener("click", function () {
                        let children = input.parentElement?.firstElementChild
                            ?.children as HTMLCollection;
                        let childrenchild = children[0].children[1].children;
                        if (childrenchild) {
                            changeAmount();
                            for (let i = 0; i < childrenchild.length; i++) {
                                if (
                                    childrenchild[i].className ==
                                    "sExtlink-processed"
                                ) {
                                    let original = childrenchild[i].innerHTML;

                                    // let child = children[i].firstElementChild;

                                    // if (child) {
                                    if (input.checked) {
                                        saveState[childrenchild[i].innerHTML] =
                                            true;
                                        localStorage.setItem(
                                            "saveState",
                                            JSON.stringify(saveState)
                                        );

                                        childrenchild[
                                            i
                                        ].innerHTML = `<s>${childrenchild[i].innerHTML}</s>`;
                                        let child: any =
                                            childrenchild[i].parentElement
                                                ?.parentElement?.parentElement
                                                ?.parentElement;

                                        child.style.opacity = "0.8";
                                        if (
                                            deleteAsign !== null &&
                                            deleteAsign
                                        ) {
                                            child.remove();
                                        }
                                    } else {
                                        let child: any =
                                            childrenchild[i].parentElement
                                                ?.parentElement?.parentElement
                                                ?.parentElement;

                                        child.style.opacity = "1";
                                        childrenchild[
                                            i
                                        ].innerHTML = `${childrenchild[
                                            i
                                        ].innerHTML.replace(/<\/?s>/g, "")}`;
                                        saveState[childrenchild[i].innerHTML] =
                                            false;

                                        localStorage.setItem(
                                            "saveState",
                                            JSON.stringify(saveState)
                                        );
                                    }
                                }
                            }
                        }
                    });
                }
            }
        }
    );
}

function gradeUpdate() {
    if (
        window.location.href == "https://schoology.shschools.org/grades/grades"
    ) {
        let gradebookElms = document.getElementsByClassName(
            "gradebook-course-grades"
        );
        for (let i = 0; i < gradebookElms.length; i++) {
            let elm = gradebookElms[i] as HTMLElement;
            elm.style.display = "block";
            let parent = document.getElementsByClassName("course-grade-value")[
                i
            ] as HTMLSpanElement;
            let gradeElm = parent.firstChild?.firstChild as HTMLElement;
            let grade = gradeElm.innerHTML;
            let title = document.getElementsByClassName(
                "gradebook-course-title"
            )[i];

            title.innerHTML += `  <span style="color:green; font-size:20px;">(${grade})<span>`;
            let gradeDivs = document.getElementsByClassName(
                " gradebook-course hierarchical-grading-report show-title interactive sGradesGradebook-processed sGradeHierarchicalReport-processed"
            )[i] as HTMLElement;
            gradeDivs.style.borderRadius = "10px";
            // gradeDivs.style.borderWidth = "10px";
            // gradeDivs.style.backgroundColor = "#474747";
            //     gradeDivs.addEventListener("onmouseover", function () {
            //         alert();
            //         gradeDivs.style.backgroundColor = "#474747";
            //     });
            //     gradeDivs.addEventListener("onmouseleave", function () {
            //         gradeDivs.style.backgroundColor = "blue";
            //     });
        }

        for (let i = 0; i < gradebookElms.length; i++) {
            let elm = gradebookElms[i] as HTMLElement;
            elm.style.display = "none";
        }
    }
}
gradeUpdate();

function notePage() {
    console.log(window.location.href);
    if (window.location.href == "https://schoology.shschools.org/notes") {
        let text = localStorage.getItem("textSave");

        document.getElementById("content-wrapper")?.remove();

        const div = document.createElement("textarea");
        const divstyle = div.style;
        divstyle.width = "1200px";
        divstyle.height = "600px";
        divstyle.borderRadius = "10px";
        div.id = "textarea";
        divstyle.position = "absolute";
        divstyle.top = "10%";
        divstyle.left = "10%";
        divstyle.padding = "15px";
        if (text) {
            div.value = text;
        }
        divstyle.fontSize = "30px";
        divstyle.zIndex = "100";
        // divstyle.fontSize = "12px";
        divstyle.fontFamily = "Roboto";
        document.getElementById("body")?.appendChild(div);
        div.addEventListener("change", function () {
            if (div) {
                localStorage.setItem("textSave", div.value);
                // alert(div.value);
            }
        });
    }
}

notePage();

// let url: any;

// function loadFrame() {
//     let link = (
//         document.getElementsByClassName("attachments-file-name")[0]
//             .firstElementChild as HTMLLinkElement
//     ).href;
//     fetch(link)
//         .then((response) => response.blob())
//         .then((blob) => {
//             // Create a blob URL for the PDF
//             url = window.URL.createObjectURL(blob);

//             // Set the src of the iframe to the Blob URL to display the PDF
//             (
//                 document.getElementsByClassName(
//                     "docviewer-iframe"
//                 )[0] as HTMLIFrameElement
//             ).src = url;
//             (
//                 document.getElementsByClassName(
//                     "view-file-popup  sExtlink-processed"
//                 )[0] as HTMLLinkElement
//             ).href = url;
//         });
// }

// let link = (
//     document.getElementsByClassName("attachments-file-name")[0]
//         .firstElementChild as HTMLLinkElement
// ).href;
// if (window.location.href.includes("materials/gp") && !link.includes(".docx")) {
//     loadFrame();
//     setTimeout(() => {
//         let centerTop = document.getElementById("center-top");

//         if (centerTop) {
//             document.head.innerHTML += `<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=open_in_full" />`;

//             centerTop.innerHTML += `<a href="${url}" target="_blank" id="expand" style=" text-decoration:none; position:absolute; left:95%; top:10%;font-size: 30px "
//      class="material-symbols-outlined">
//     open_in_full
//     </a>`;

//             centerTop.innerHTML += `<a  onclick="loadFrame()"  target="_blank" id="expand" style=" cursor: pointer; text-decoration:none; position:absolute; left:91%; top:10%;font-size: 30px "
//     class="material-symbols-outlined">
//     frame_reload
//     </a>`;
//         }
//     }, 1000);
// }
//

function newbtn() {
    let parent = document.getElementsByClassName(
        "_2trRU _2K08O fSqCh _1tpub"
    )[1];
    let item = parent.firstElementChild?.cloneNode() as HTMLLIElement;
    if (item) {
        item.id;
        parent.appendChild(item);
    }
}
newbtn();

// let btnTemp = document.getElementById("edit-submit") as HTMLInputElement;

// btnTemp.id = "edit-submitTemp";
// let btn = document.getElementById("edit-submit") as HTMLInputElement;
// btnTemp.id = "edit-submit";
// alert(btn.value);
// // let btn = document.getElementById("edit-submit") as HTMLInputElement;

// btn.addEventListener("hover", function () {
//     if (btn.value == "Submit") {
//         alert("submited");
//     }
// });

(
    document.getElementsByClassName(
        "button-reset clickable refresh-button"
    )[0] as HTMLButtonElement
).click();
// setInterval(() => {
//     let RecentCompletelist = document.getElementsByClassName(
//         "recently-completed-event"
//     );

//     for (let i = 0; i < RecentCompletelist.length; i++) {
//         document.body.innerHTML += `<iframe src="${
//             (RecentCompletelist[i] as any).childNodes[0].childNodes[1]
//                 .childNodes[1].href
//         }" ></iframe>`;
//     }
// }, 2000);
